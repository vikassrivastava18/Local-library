"use strict";(self["webpackChunklibrary"]=self["webpackChunklibrary"]||[]).push([[31],{7031:function(o,t,e){e.r(t),e.d(t,{default:function(){return P}});var a=e(6768),s=e(4232),l=e(2871);const n={key:0},r={class:"container mt-5"},i={class:"text-success"},c={class:"text-danger"},d={class:"card shadow"},u={key:0,class:"row g-0"},k={class:"col-md-3 d-flex p-2"},b=["src"],m=["src"],h={key:2,src:l,class:"img-fluid rounded-start",alt:"Book Cover",style:{"max-height":"300px","object-fit":"contain"}},g={class:"col-md-9"},p={class:"card-header"},y={style:{display:"inline"}},v={key:0,type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#exampleModal",style:{float:"right"}},L={key:1,class:"text-primary",style:{float:"right","font-weight":"500"}},f={class:"card-body"},C={class:"card-title"},w={class:"card-text"},_={class:"card-text"},x={key:0},E={class:"text-muted"},B={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},A={class:"modal-dialog modal-dialog-centered"},X={class:"modal-content rounded-4 shadow"},S={class:"modal-body"},j={class:"modal-footer"};function I(o,t,e,l,I,$){const D=(0,a.g2)("nav-component"),F=(0,a.g2)("LoaderComponent"),M=(0,a.g2)("footer-component");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(D),(0,a.Lk)("main",null,[I.loading?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.bF)(F)])):(0,a.Q3)("",!0),(0,a.Lk)("div",r,[(0,a.Lk)("h5",i,(0,s.v_)(I.success),1),(0,a.Lk)("h5",c,(0,s.v_)(I.error),1),(0,a.Lk)("div",d,[I.book?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",k,[I.book.cover?((0,a.uX)(),(0,a.CE)("img",{key:0,src:I.book.cover,class:"img-fluid rounded-start",alt:"Book Cover",style:{"max-height":"300px","object-fit":"contain"}},null,8,b)):I.book.cover_url?((0,a.uX)(),(0,a.CE)("img",{key:1,src:I.book.cover_url,class:"img-fluid rounded-start",alt:"Book Cover",style:{"max-height":"300px","object-fit":"contain"}},null,8,m)):((0,a.uX)(),(0,a.CE)("img",h))]),(0,a.Lk)("div",g,[(0,a.Lk)("div",p,[(0,a.Lk)("h4",y,(0,s.v_)(I.book.title),1),I.booksAvailable>0?((0,a.uX)(),(0,a.CE)("button",v,"Borrow ")):((0,a.uX)(),(0,a.CE)("span",L,"Sorry, the book is not available currently. "))]),(0,a.Lk)("div",f,[(0,a.Lk)("h5",C,"Author: "+(0,s.v_)(I.book.author_name),1),(0,a.Lk)("p",w,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Summary:",-1)),(0,a.eW)(" "+(0,s.v_)(I.book.summary),1)]),(0,a.Lk)("p",_,[t[2]||(t[2]=(0,a.Lk)("strong",null,"ISBN:",-1)),(0,a.eW)(" "+(0,s.v_)(I.book.isbn),1)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(I.book.instances,o=>((0,a.uX)(),(0,a.CE)("div",{key:o.id,class:"mb-3 p-4"},[(0,a.Lk)("p",{class:(0,s.C4)({"text-success":"a"===o.status,"text-danger":"m"===o.status,"text-warning":"a"!==o.status&&"m"!==o.status})},(0,s.v_)(o.status_display),3),"o"==o.status?((0,a.uX)(),(0,a.CE)("p",x,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Due to be returned:",-1)),(0,a.eW)(" "+(0,s.v_)(o.due_back),1)])):(0,a.Q3)("",!0),(0,a.Lk)("p",null,[t[4]||(t[4]=(0,a.Lk)("strong",null,"Imprint:",-1)),(0,a.eW)(" "+(0,s.v_)(o.imprint),1)]),(0,a.Lk)("p",E,[t[5]||(t[5]=(0,a.Lk)("strong",null,"Id:",-1)),(0,a.eW)(" "+(0,s.v_)(o.id),1)])]))),128))])])])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",B,[(0,a.Lk)("div",A,[(0,a.Lk)("div",X,[t[7]||(t[7]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"Borrow Agreement"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,a.Lk)("div",S," You agree to return this book by "+(0,s.v_)(I.due_date)+" in good shape. ",1),(0,a.Lk)("div",j,[t[6]||(t[6]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=(...o)=>$.borrowBook&&$.borrowBook(...o))}," Agree ")])])])])]),(0,a.bF)(M)],64)}e(8111),e(2489),e(1701);var $=e(6698),D=e(3901),F=e(1215),M=e(2169),T={name:"BookComponent",data(){return{book:null,loading:!0,booksAvailable:0,success:"",error:"",due_date:new Date((new Date).setMonth((new Date).getMonth()+2)).toISOString().split("T")[0]}},components:{NavComponent:D.A,FooterComponent:$.A,LoaderComponent:F.A},methods:{async getBookDetails(){console.log(this.$route.params.id);const o=this.$route.params.id,t=`${M.E}catalog/books/${o}`;await new Promise(o=>setTimeout(o,500));try{const o=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"token "+localStorage.getItem("auth_token")}});if(o.ok){const t=await o.json();this.book=t,console.log("book: ",t),this.booksAvailable=this.book.instances.filter(o=>"a"===o.status).length}else{const t=await o.json();this.error=t["non_field_errors"]}}catch(e){this.error=`Error occured: ${e}`}finally{this.loading=!1}},async borrowBook(){const o=this.book.instances.filter(o=>"a"===o.status).map(o=>o.id)[0],t=`${M.E}catalog/borrow-book/${o}`;try{const o=await fetch(t,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"token "+localStorage.getItem("auth_token")}});if(o.ok)console.log("Sucessfully loaned"),this.success="Book has been assigned to you on loan, please collect from library by tomorrow!";else{const t=await o.json();this.error=t["error"]}}catch(e){this.error="Network error. Please try again."}finally{this.loading=!1,document.querySelector(".btn-close").click()}}},mounted(){this.getBookDetails()}},W=e(1241);const N=(0,W.A)(T,[["render",I]]);var P=N}}]);
//# sourceMappingURL=31.ae7638f4.js.map