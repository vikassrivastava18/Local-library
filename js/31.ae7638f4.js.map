{"version":3,"file":"js/31.ae7638f4.js","mappings":"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","sources":["webpack://library/./src/pages/books/BookDetailComponent.vue","webpack://library/./src/pages/books/BookDetailComponent.vue?cd5b"],"sourcesContent":["<template>\r\n    <!-- Navbar -->\r\n    <nav-component />\r\n    <!-- Main Content -->\r\n    <main>\r\n        <div v-if=\"loading\">\r\n            <LoaderComponent />\r\n        </div>\r\n        <div class=\"container mt-5\">\r\n            <h5 class=\"text-success\">{{ success }}</h5>\r\n            <h5 class=\"text-danger\">{{ error }}</h5>\r\n\r\n            <div class=\"card shadow\">\r\n                <div v-if=\"book\" class=\"row g-0\">\r\n                    <div class=\"col-md-3 d-flex p-2\">\r\n                        <img v-if=\"book.cover\" :src=\"book.cover\" class=\"img-fluid rounded-start\" alt=\"Book Cover\"\r\n                            style=\"max-height: 300px; object-fit: contain;\">\r\n                        <img v-else-if=\"book.cover_url\" :src=\"book.cover_url\" class=\"img-fluid rounded-start\" alt=\"Book Cover\"\r\n                            style=\"max-height: 300px; object-fit: contain;\">\r\n                        <img v-else src=\"@/assets/book.jpg\" class=\"img-fluid rounded-start\" alt=\"Book Cover\"\r\n                            style=\"max-height: 300px; object-fit: contain;\">\r\n\r\n                    </div>\r\n                    <div class=\"col-md-9\">\r\n                        <div class=\"card-header\">\r\n                            <h4 style=\"display: inline;\">{{ book.title }}</h4>\r\n\r\n                            <button v-if=\"booksAvailable > 0\" \r\n                                type=\"button\"\r\n                                class=\"btn btn-primary\" data-bs-toggle=\"modal\" \r\n                                data-bs-target=\"#exampleModal\"\r\n                                style=\"float: right;\">Borrow\r\n                            </button>\r\n                            <span v-else\r\n                                class=\"text-primary\"\r\n                                style=\"float: right; font-weight: 500;\">Sorry, the book is not available currently.\r\n                            </span>\r\n\r\n                        </div>\r\n                        <div class=\"card-body\">\r\n                            <h5 class=\"card-title\">Author: {{ book.author_name }}</h5>\r\n                            <p class=\"card-text\"><strong>Summary:</strong> {{ book.summary }}</p>\r\n                            <p class=\"card-text\"><strong>ISBN:</strong> {{ book.isbn }}</p>\r\n\r\n                            <div v-for=\"copy in book.instances\" :key=\"copy.id\" class=\"mb-3 p-4\">\r\n                                <p :class=\"{\r\n                                    'text-success': copy.status === 'a',\r\n                                    'text-danger': copy.status === 'm',\r\n                                    'text-warning': copy.status !== 'a' && copy.status !== 'm'\r\n                                }\">\r\n                                    {{ copy.status_display }}\r\n                                </p>\r\n                                <p v-if=\"copy.status == 'o'\">\r\n                                    <strong>Due to be returned:</strong> {{ copy.due_back }}\r\n                                </p>\r\n                                <p>\r\n                                    <strong>Imprint:</strong> {{ copy.imprint }}\r\n                                </p>\r\n                                <p class=\"text-muted\">\r\n                                    <strong>Id:</strong> {{ copy.id }}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Modal -->\r\n        <div class=\"modal fade\" id=\"exampleModal\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\">\r\n                <div class=\"modal-content rounded-4 shadow\">\r\n                    <div class=\"modal-header\">\r\n                        <h5 class=\"modal-title\" id=\"exampleModalLabel\">Borrow Agreement</h5>\r\n                        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                    </div>\r\n\r\n                    <div class=\"modal-body\">\r\n                        You agree to return this book by {{due_date}} in good shape.\r\n                    </div>\r\n\r\n                    <div class=\"modal-footer\">\r\n                        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\r\n                            Close\r\n                        </button>\r\n                        <button type=\"button\" \r\n                            class=\"btn btn-primary\"\r\n                            @click=\"borrowBook\">\r\n                            Agree\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </main>\r\n    <!-- Footer -->\r\n    <footer-component />\r\n</template>\r\n\r\n<script>\r\nimport FooterComponent from '../../components/common/FooterComponent.vue';\r\nimport NavComponent from '../../components/common/NavComponent.vue';\r\nimport LoaderComponent from '../../components/common/LoaderComponent.vue';\r\nimport { backendUrl } from '@/config';\r\n\r\nexport default {\r\n    name: 'BookComponent',\r\n    data() {\r\n        return {\r\n            book: null,\r\n            loading: true,\r\n            booksAvailable: 0,\r\n            success: '',\r\n            error: '',\r\n            due_date: new Date(new Date().setMonth(new Date().getMonth() + 2)).toISOString().split('T')[0],\r\n        }\r\n    },\r\n    components: {\r\n        NavComponent,\r\n        FooterComponent,\r\n        LoaderComponent\r\n    },\r\n    methods: {\r\n        async getBookDetails() {\r\n            console.log(this.$route.params.id);\r\n            const id = this.$route.params.id\r\n            const url = `${backendUrl}catalog/books/${id}`;\r\n            await new Promise(resolve => setTimeout(resolve, 500));\r\n            try {\r\n                const response = await fetch(url, {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Authorization': 'token ' + localStorage.getItem('auth_token')\r\n                    },\r\n                })\r\n                if (response.ok) {\r\n                    const data = await response.json(); // <-- fix here\r\n                    this.book = data;\r\n                    console.log(\"book: \", data);\r\n                    \r\n                    this.booksAvailable = this.book.instances.filter(inst => inst.status === 'a').length\r\n\r\n                } else {\r\n                    const data = await response.json()\r\n                    this.error = data['non_field_errors']\r\n                }\r\n            } catch (err) {\r\n                this.error = `Error occured: ${err}`\r\n            } finally {\r\n                this.loading = false\r\n            }\r\n        },\r\n\r\n        async borrowBook() {\r\n            // Implement borrow logic here\r\n            const id = this.book.instances.filter(inst => inst.status === 'a').map(inst => inst.id)[0]\r\n            const url = `${backendUrl}catalog/borrow-book/${id}`;\r\n            try {\r\n                const response = await fetch(url, {\r\n                    method: 'PUT',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Authorization': 'token ' + localStorage.getItem('auth_token')\r\n                    },\r\n                })\r\n                if (response.ok) {\r\n                    console.log('Sucessfully loaned');\r\n                    this.success = 'Book has been assigned to you on loan, please collect from library by tomorrow!';\r\n\r\n                } else {\r\n                    const data = await response.json()\r\n                    this.error = data['error']\r\n                }\r\n            } catch (err) {\r\n                this.error = 'Network error. Please try again.'\r\n            } finally {\r\n                this.loading = false\r\n                // Close the modal\r\n                document.querySelector(\".btn-close\").click()\r\n            }\r\n        }\r\n    },\r\n    mounted() {\r\n        this.getBookDetails()\r\n\r\n    }\r\n}\r\n</script>","import { render } from \"./BookDetailComponent.vue?vue&type=template&id=eda71d48\"\nimport script from \"./BookDetailComponent.vue?vue&type=script&lang=js\"\nexport * from \"./BookDetailComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","src","_imports_0","alt","style","type","id","tabindex","_createVNode","_component_nav_component","_createElementVNode","$data","loading","_createElementBlock","_hoisted_1","_component_LoaderComponent","_hoisted_2","_hoisted_3","_toDisplayString","success","_hoisted_4","error","_hoisted_5","book","_hoisted_6","_hoisted_7","cover","cover_url","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","title","booksAvailable","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","author_name","_hoisted_18","summary","_hoisted_19","isbn","_Fragment","_renderList","instances","copy","key","_normalizeClass","status","status_display","_hoisted_20","due_back","imprint","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","due_date","_hoisted_26","onClick","_cache","args","$options","borrowBook","_component_footer_component","name","data","Date","setMonth","getMonth","toISOString","split","components","NavComponent","FooterComponent","LoaderComponent","methods","getBookDetails","console","log","this","$route","params","url","backendUrl","Promise","resolve","setTimeout","response","fetch","method","headers","localStorage","getItem","ok","json","filter","inst","length","err","map","document","querySelector","click","mounted","__exports__","render"],"sourceRoot":""}